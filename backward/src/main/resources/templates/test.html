<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>ECharts</title>
  <!-- 引入 echarts.js -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
  <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.5.1.min.js"></script>
</head>

<body>
  <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
  <div id="main" style="width: 600px;height:400px;"></div>
  <script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('main'));
    var dates = [];
    
    //请求后台数据
    $.ajax({
      type: "get",
      url: "/warning",
      contentType: "application/json",
      success: function (res) {
        console.log("=====res: =======")
        console.log(res);
        for (var i = 0; i < res.length; i++) {
          var date = +echarts.time.parse(res[i].data[0] + '-' + res[i].data[1] + '-' + res[i].data[2]);
          dates.push([
            echarts.time.format(time, '{yyyy}-{MM}-{dd}', false),
            res[i].data[3]
          ]);
        }
        myChart.setOption({
          title: {
            top: 30,
            left: 'center',
            text: '土壤温度每日报警次数'
          },
          tooltip: {},
          visualMap: {
            min: 0,
            max: 10000,
            type: 'piecewise',
            orient: 'horizontal',
            left: 'center',
            top: 65
          },
          calendar: {
            top: 120,
            left: 30,
            right: 30,
            cellSize: ['auto', 13],
            range: '2023',
            itemStyle: {
              borderWidth: 0.5
            },
            yearLabel: { show: false }
          },
          series: {
            type: 'heatmap',
            coordinateSystem: 'calendar',
            data: dates
          }
        });
      }
    });

  </script>
</body>

</html>